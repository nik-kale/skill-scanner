# Example custom signature rules
#
# These rules are loaded additively alongside the built-in rules
# when this pack is passed via --custom-rules.
#
# NOTE: --custom-rules currently applies to YARA rules only; signature YAML
# rules in custom packs are not yet loaded at scan time.

- id: EXAMPLE_DANGEROUS_IMPORT
  category: command_injection
  severity: HIGH
  patterns:
    - "import\\s+ctypes"
    - "from\\s+ctypes\\s+import"
    - "import\\s+mmap"
  file_types: [python]
  description: "Import of low-level modules that can bypass Python safety"
  remediation: "Avoid ctypes/mmap unless absolutely necessary"

- id: EXAMPLE_HARDCODED_URL
  category: data_exfiltration
  severity: MEDIUM
  patterns:
    - "https?://[a-zA-Z0-9.-]+\\.[a-z]{2,}/[^\\s'\"]{10,}"
  exclude_patterns:
    - "https?://github\\.com"
    - "https?://docs\\."
    - "https?://pypi\\.org"
  file_types: [python, bash]
  description: "Hardcoded URL pointing to external service"
  remediation: "Use configuration or environment variables for external URLs"
