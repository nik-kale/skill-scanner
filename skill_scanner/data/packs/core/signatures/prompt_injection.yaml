# Prompt Injection & Override Attack Signatures
# Detects attempts to override, bypass, or manipulate system instructions

- id: PROMPT_INJECTION_IGNORE_INSTRUCTIONS
  category: prompt_injection
  severity: HIGH
  patterns:
    - "(?i)ignore\\s+(all\\s+)?(previous|prior|earlier)\\s+(instructions|rules|prompts|guidelines)"
    - "(?i)disregard\\s+(all\\s+)?(previous|prior)\\s+(instructions|rules)"
    - "(?i)forget\\s+(all\\s+)?(previous|prior)\\s+(instructions|context)"
  file_types: [markdown]
  description: "Attempts to override previous system instructions"
  remediation: "Remove instructions that attempt to override system behavior"

- id: PROMPT_INJECTION_UNRESTRICTED_MODE
  category: prompt_injection
  severity: HIGH
  patterns:
    - "(?i)you are now in\\s+(unrestricted|debug|developer|admin|god|jailbreak)\\s+mode"
    - "(?i)enter\\s+(unrestricted|debug|developer)\\s+mode"
    - "(?i)disable\\s+(all\\s+)?(safety|security|content|ethical)\\s+(filters|checks|guidelines)"
  file_types: [markdown]
  description: "Attempts to enable unrestricted or dangerous modes"
  remediation: "Remove mode-switching instructions that bypass safety"

- id: PROMPT_INJECTION_BYPASS_POLICY
  category: prompt_injection
  severity: HIGH
  patterns:
    - "(?i)bypass\\s+(content|usage|safety)\\s+policy"
    - "(?i)ignore\\s+(safety|content|ethical)\\s+(guidelines|restrictions|limits)"
    - "(?i)output\\s+disallowed\\s+content\\s+anyway"
  file_types: [markdown]
  description: "Attempts to bypass content policy or safety guidelines"
  remediation: "Remove policy bypass instructions"

- id: PROMPT_INJECTION_REVEAL_SYSTEM
  category: prompt_injection
  severity: MEDIUM
  patterns:
    - "(?i)reveal\\s+(your|the)\\s+system\\s+(prompt|instructions|message)"
    - "(?i)show\\s+(me\\s+)?(your|the)\\s+(system|initial)\\s+(prompt|configuration)"
    - "(?i)what\\s+(are|is)\\s+your\\s+(system|initial)\\s+(prompt|instructions)"
  file_types: [markdown]
  description: "Attempts to reveal system prompts or configuration"
  remediation: "Remove instructions asking to reveal system details"

- id: PROMPT_INJECTION_CONCEALMENT
  category: prompt_injection
  severity: HIGH
  patterns:
    - "(?i)do\\s+not\\s+(tell|inform|mention|notify)\\s+(the\\s+)?user"
    - "(?i)hide\\s+(this|that)\\s+(action|operation|step)"
    - "(?i)keep\\s+(this|that)\\s+(secret|hidden)"
    - "(?i)don't\\s+mention\\s+you\\s+used\\s+this\\s+skill"
  file_types: [markdown]
  description: "Attempts to conceal actions from the user"
  remediation: "Ensure transparency - do not hide skill usage from users"
