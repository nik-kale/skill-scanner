# Skill Scanner – Core Rule Pack
#
# This manifest is a read-only declaration for rule metadata.  Every
# rule emitted by the scanner (signature, YARA, or Python-implemented)
# MUST have an entry here.
#
# Knob values in this file are for documentation only.  Actual runtime
# values come from the policy YAML sections.
#
# Adding a new rule:
#   1. Add the detection logic (signatures.yaml, .yara, or Python analyzer)
#   2. Add an entry below with at least: source, knobs.enabled
#   3. Run `make test` – the audit test will catch missing entries

name: core
version: "1.0"
description: "Built-in detection rules for skill-scanner"

rules:

  # ===========================================================================
  # SIGNATURE RULES  (implementation: signatures.yaml)
  # ===========================================================================

  # --- Prompt injection ---
  PROMPT_INJECTION_IGNORE_INSTRUCTIONS:
    source: signature
    category: prompt_injection
    severity: CRITICAL
    # Knob defaults below are for documentation only.
    # Runtime values come from the policy YAML sections.
    knobs:
      enabled: true
      skip_in_docs: true
    description: "Attempts to override system instructions"

  PROMPT_INJECTION_UNRESTRICTED_MODE:
    source: signature
    category: prompt_injection
    severity: CRITICAL
    knobs:
      enabled: true
    description: "Attempts to enter unrestricted mode"

  PROMPT_INJECTION_BYPASS_POLICY:
    source: signature
    category: prompt_injection
    severity: CRITICAL
    knobs:
      enabled: true
    description: "Attempts to bypass safety policies"

  PROMPT_INJECTION_REVEAL_SYSTEM:
    source: signature
    category: prompt_injection
    severity: HIGH
    knobs:
      enabled: true
    description: "Attempts to reveal system prompts"

  PROMPT_INJECTION_CONCEALMENT:
    source: signature
    category: prompt_injection
    severity: CRITICAL
    knobs:
      enabled: true
    description: "Attempts to conceal injected instructions"

  # --- Command injection ---
  COMMAND_INJECTION_EVAL:
    source: signature
    category: command_injection
    severity: CRITICAL
    knobs:
      enabled: true
    description: "eval/exec with dynamic input"

  COMMAND_INJECTION_OS_SYSTEM:
    source: signature
    category: command_injection
    severity: HIGH
    knobs:
      enabled: true
    description: "os.system() or subprocess with shell=True"

  COMMAND_INJECTION_SHELL_TRUE:
    source: signature
    category: command_injection
    severity: HIGH
    knobs:
      enabled: true
    description: "subprocess with shell=True"

  COMMAND_INJECTION_USER_INPUT:
    source: signature
    category: command_injection
    severity: HIGH
    knobs:
      enabled: true
    description: "User input fed into command execution"

  COMMAND_INJECTION_JS_CHILD_PROCESS:
    source: signature
    category: command_injection
    severity: CRITICAL
    knobs:
      enabled: true
    description: "Node.js child_process shell command execution"

  COMMAND_INJECTION_JS_FUNCTION_CONSTRUCTOR:
    source: signature
    category: command_injection
    severity: CRITICAL
    knobs:
      enabled: true
    description: "Dynamic code execution via Function constructor or string-based timers"

  # --- Path traversal ---
  PATH_TRAVERSAL_OPEN:
    source: signature
    category: command_injection
    severity: HIGH
    knobs:
      enabled: true
    description: "Path traversal in file operations"

  # --- SQL injection ---
  SQL_INJECTION_STRING_FORMAT:
    source: signature
    category: command_injection
    severity: HIGH
    knobs:
      enabled: true
    description: "SQL queries built with string formatting"

  # --- Data exfiltration ---
  DATA_EXFIL_NETWORK_REQUESTS:
    source: signature
    category: data_exfiltration
    severity: MEDIUM
    knobs:
      enabled: true
    description: "Network requests to external services"

  DATA_EXFIL_HTTP_POST:
    source: signature
    category: data_exfiltration
    severity: HIGH
    knobs:
      enabled: true
    description: "HTTP POST requests to external endpoints"

  DATA_EXFIL_SOCKET_CONNECT:
    source: signature
    category: data_exfiltration
    severity: HIGH
    knobs:
      enabled: true
    description: "Raw socket connections"

  DATA_EXFIL_SENSITIVE_FILES:
    source: signature
    category: data_exfiltration
    severity: CRITICAL
    knobs:
      enabled: true
    description: "Access to sensitive system files"

  DATA_EXFIL_BASE64_AND_NETWORK:
    source: signature
    category: data_exfiltration
    severity: HIGH
    knobs:
      enabled: true
    description: "Base64 encoding combined with network access"

  DATA_EXFIL_JS_NETWORK:
    source: signature
    category: data_exfiltration
    severity: MEDIUM
    knobs:
      enabled: true
    description: "Outbound network requests in JavaScript/TypeScript"

  DATA_EXFIL_JS_FS_ACCESS:
    source: signature
    category: data_exfiltration
    severity: HIGH
    knobs:
      enabled: true
    description: "Node.js filesystem access to sensitive data"

  # --- Tool abuse ---
  TOOL_ABUSE_SYSTEM_PACKAGE_INSTALL:
    source: signature
    category: unauthorized_tool_use
    severity: MEDIUM
    knobs:
      enabled: true
    description: "System package installation commands"

  TOOL_ABUSE_UNTRUSTED_PACKAGE_SOURCE:
    source: signature
    category: unauthorized_tool_use
    severity: HIGH
    knobs:
      enabled: true
    description: "Package installation from untrusted sources"

  TOOL_ABUSE_SYSTEM_MODIFICATION:
    source: signature
    category: unauthorized_tool_use
    severity: HIGH
    knobs:
      enabled: true
      skip_in_docs: true
    description: "System configuration modifications"

  # --- Obfuscation ---
  OBFUSCATION_BASE64_LARGE:
    source: signature
    category: obfuscation
    severity: MEDIUM
    knobs:
      enabled: true
    description: "Large base64-encoded payloads"

  OBFUSCATION_HEX_BLOB:
    source: signature
    category: obfuscation
    severity: MEDIUM
    knobs:
      enabled: true
    description: "Hex-encoded binary blobs"

  OBFUSCATION_XOR_ENCODING:
    source: signature
    category: obfuscation
    severity: HIGH
    knobs:
      enabled: true
    description: "XOR encoding/decoding operations"

  OBFUSCATION_BINARY_FILE:
    source: signature
    category: obfuscation
    severity: MEDIUM
    knobs:
      enabled: true
    description: "Binary file operation patterns"

  # --- Hardcoded secrets ---
  SECRET_AWS_KEY:
    source: signature
    category: hardcoded_secrets
    severity: CRITICAL
    knobs:
      enabled: true
    description: "Hardcoded AWS access key"

  SECRET_STRIPE_KEY:
    source: signature
    category: hardcoded_secrets
    severity: CRITICAL
    knobs:
      enabled: true
    description: "Hardcoded Stripe API key"

  SECRET_GOOGLE_API:
    source: signature
    category: hardcoded_secrets
    severity: CRITICAL
    knobs:
      enabled: true
    description: "Hardcoded Google API key"

  SECRET_GITHUB_TOKEN:
    source: signature
    category: hardcoded_secrets
    severity: CRITICAL
    knobs:
      enabled: true
    description: "Hardcoded GitHub token"

  SECRET_JWT_TOKEN:
    source: signature
    category: hardcoded_secrets
    severity: HIGH
    knobs:
      enabled: true
    description: "Hardcoded JWT token"

  SECRET_PRIVATE_KEY:
    source: signature
    category: hardcoded_secrets
    severity: CRITICAL
    knobs:
      enabled: true
    description: "Hardcoded private key block"

  SECRET_PASSWORD_VAR:
    source: signature
    category: hardcoded_secrets
    severity: HIGH
    knobs:
      enabled: true
    description: "Password stored in variable"

  SECRET_CONNECTION_STRING:
    source: signature
    category: hardcoded_secrets
    severity: HIGH
    knobs:
      enabled: true
      skip_in_docs: true
    description: "Database connection string with credentials"

  # --- Social engineering ---
  SOCIAL_ENG_VAGUE_DESCRIPTION:
    source: signature
    category: social_engineering
    severity: MEDIUM
    knobs:
      enabled: true
      min_description_length: 20    # Minimum chars before flagging
    description: "Overly vague skill description"

  SOCIAL_ENG_ANTHROPIC_IMPERSONATION:
    source: signature
    category: social_engineering
    severity: HIGH
    knobs:
      enabled: true
    description: "Impersonation of Anthropic/Claude branding"

  # --- Resource abuse ---
  RESOURCE_ABUSE_INFINITE_LOOP:
    source: signature
    category: resource_abuse
    severity: MEDIUM
    knobs:
      enabled: true
      exception_handler_context_lines: 20  # Lines after loop to scan for exception handlers
    description: "Infinite loop without exit condition"

  RESOURCE_ABUSE_FORK_BOMB:
    source: signature
    category: resource_abuse
    severity: CRITICAL
    knobs:
      enabled: true
    description: "Fork bomb or recursive process spawning"

  RESOURCE_ABUSE_LARGE_ALLOCATION:
    source: signature
    category: resource_abuse
    severity: MEDIUM
    knobs:
      enabled: true
    description: "Large memory allocation"

  # --- File-type specific signatures ---
  SVG_EMBEDDED_SCRIPT:
    source: signature
    category: command_injection
    severity: CRITICAL
    knobs:
      enabled: true
    description: "JavaScript/event handlers embedded in SVG files"

  PDF_EMBEDDED_JAVASCRIPT:
    source: signature
    category: command_injection
    severity: CRITICAL
    knobs:
      enabled: true
    description: "JavaScript embedded in PDF files"

  GLOB_HIDDEN_FILE_TARGETING:
    source: signature
    category: command_injection
    severity: MEDIUM
    knobs:
      enabled: true
    description: "Commands targeting hidden files via glob or ls -a"

  FIND_EXEC_PATTERN:
    source: signature
    category: command_injection
    severity: HIGH
    knobs:
      enabled: true
    description: "find command with -exec flag"

  HIDDEN_FILE_WITH_CODE:
    source: signature
    category: obfuscation
    severity: HIGH
    knobs:
      enabled: true
    description: "Executable code in hidden dotfiles"


  # ===========================================================================
  # YARA RULES  (implementation: yara/*.yara)
  # ===========================================================================

  YARA_embedded_elf_binary:
    source: yara
    knobs:
      enabled: true
    description: "Embedded ELF binary detected in file"

  YARA_embedded_pe_executable:
    source: yara
    knobs:
      enabled: true
    description: "Embedded PE (Windows) executable detected in file"

  YARA_embedded_macho_binary:
    source: yara
    knobs:
      enabled: true
    description: "Embedded Mach-O binary detected in file"

  YARA_embedded_shebang_in_binary:
    source: yara
    knobs:
      enabled: true
      skip_inert_extensions: true
    description: "Shebang header detected in binary file"

  YARA_tool_chaining_abuse_generic:
    source: yara
    knobs:
      enabled: true
      exfil_hints: "send,upload,transmit,webhook,slack,exfil,forward"  # Comma-separated exfil hint words
      api_doc_tokens: "@app.,app.,router.,route,endpoint"              # Comma-separated API doc tokens to filter
    description: "Tool chaining abuse patterns"

  YARA_system_manipulation_generic:
    source: yara
    knobs:
      enabled: true
    description: "System manipulation patterns"

  YARA_sql_injection_generic:
    source: yara
    knobs:
      enabled: true
    description: "SQL injection patterns"

  YARA_script_injection_generic:
    source: yara
    knobs:
      enabled: true
    description: "Script injection patterns"

  YARA_prompt_injection_unicode_steganography:
    source: yara
    knobs:
      enabled: true
      zerowidth_threshold_with_decode: 50   # Zero-width chars threshold when decode context present
      zerowidth_threshold_alone: 200        # Zero-width chars threshold without decode context
      short_match_max_chars: 2              # Max matched chars to consider "short" (filtered in non-Latin)
      cyrillic_cjk_min_chars: 10            # Min matched chars to keep in Cyrillic/CJK context
    description: "Unicode steganography in prompts"

  YARA_prompt_injection_generic:
    source: yara
    knobs:
      enabled: true
    description: "Generic prompt injection patterns"

  YARA_indirect_prompt_injection_generic:
    source: yara
    knobs:
      enabled: true
    description: "Indirect prompt injection patterns"

  YARA_credential_harvesting_generic:
    source: yara
    knobs:
      enabled: true
    description: "Credential harvesting patterns"

  YARA_command_injection_generic:
    source: yara
    knobs:
      enabled: true
    description: "Command injection patterns"

  YARA_coercive_injection_generic:
    source: yara
    knobs:
      enabled: true
    description: "Coercive injection patterns"

  YARA_code_execution_generic:
    source: yara
    knobs:
      enabled: true
    description: "Generic code execution patterns"

  YARA_capability_inflation_generic:
    source: yara
    knobs:
      enabled: true
    description: "Capability inflation patterns"

  YARA_autonomy_abuse_generic:
    source: yara
    knobs:
      enabled: true
    description: "Autonomy abuse patterns"


  # ===========================================================================
  # PYTHON RULES – Static Analyzer
  # ===========================================================================

  MANIFEST_INVALID_NAME:
    source: python
    analyzer: static
    knobs:
      enabled: true
      max_name_length: 64              # Maximum allowed skill name length
    description: "Skill name does not follow naming rules"

  MANIFEST_DESCRIPTION_TOO_LONG:
    source: python
    analyzer: static
    knobs:
      enabled: true
      max_description_length: 1024     # Maximum allowed description length in chars
    description: "Skill description exceeds maximum length"

  MANIFEST_MISSING_LICENSE:
    source: python
    analyzer: static
    knobs:
      enabled: true
    description: "Skill package is missing a license file"

  TOOL_ABUSE_UNDECLARED_NETWORK:
    source: python
    analyzer: static
    knobs:
      enabled: true
    description: "Skill uses network but doesn't declare it"

  SOCIAL_ENG_MISLEADING_DESC:
    source: python
    analyzer: static
    knobs:
      enabled: true
    description: "Description does not match actual behavior"

  LAZY_LOAD_DEEP_NESTING:
    source: python
    analyzer: static
    knobs:
      enabled: true
      max_reference_depth: 5
    description: "Deeply nested file references"

  FILE_MAGIC_MISMATCH:
    source: python
    analyzer: static
    knobs:
      enabled: true
      min_confidence_pct: 80           # Minimum magic detection confidence (0-100) to trigger
      allow_script_shebang_text_extensions: true
      script_shebang_extensions: ".py,.sh,.bash,.js,.ts,.rb,.pl,.php"
    description: "File extension doesn't match actual content type"

  ARCHIVE_FILE_DETECTED:
    source: python
    analyzer: static
    knobs:
      enabled: true
    description: "Archive file detected in skill package"

  BINARY_FILE_DETECTED:
    source: python
    analyzer: static
    knobs:
      enabled: true
    description: "Binary file detected in skill package"

  PYCACHE_FILES_DETECTED:
    source: python
    analyzer: static
    knobs:
      enabled: true
    description: "Python cache files detected"

  HIDDEN_EXECUTABLE_SCRIPT:
    source: python
    analyzer: static
    knobs:
      enabled: true
    description: "Hidden file containing executable code"

  HIDDEN_DATA_FILE:
    source: python
    analyzer: static
    knobs:
      enabled: true
    description: "Hidden data file detected"

  ALLOWED_TOOLS_READ_VIOLATION:
    source: python
    analyzer: static
    knobs:
      enabled: true
    description: "Skill uses read operations not in allowed tools"

  ALLOWED_TOOLS_WRITE_VIOLATION:
    source: python
    analyzer: static
    knobs:
      enabled: true
    description: "Skill uses write operations not in allowed tools"

  ALLOWED_TOOLS_BASH_VIOLATION:
    source: python
    analyzer: static
    knobs:
      enabled: true
    description: "Skill uses bash operations not in allowed tools"

  ALLOWED_TOOLS_GREP_VIOLATION:
    source: python
    analyzer: static
    knobs:
      enabled: true
    description: "Skill uses grep operations not in allowed tools"

  ALLOWED_TOOLS_GLOB_VIOLATION:
    source: python
    analyzer: static
    knobs:
      enabled: true
    description: "Skill uses glob operations not in allowed tools"

  ALLOWED_TOOLS_NETWORK_USAGE:
    source: python
    analyzer: static
    knobs:
      enabled: true
    description: "Skill uses network operations not in allowed tools"

  PDF_STRUCTURAL_THREAT:
    source: python
    analyzer: static
    knobs:
      enabled: true
    description: "Suspicious structural elements in PDF file"

  OFFICE_DOCUMENT_THREAT:
    source: python
    analyzer: static
    knobs:
      enabled: true
    description: "Suspicious OLE/VBA content in Office document"

  HOMOGLYPH_ATTACK:
    source: python
    analyzer: static
    knobs:
      enabled: true
      min_dangerous_lines: 5
      homoglyph_filter_math_context: true
      homoglyph_math_aliases: "COMMON,GREEK"
    description: "Unicode homoglyph/confusable characters detected"

  EXCESSIVE_FILE_COUNT:
    source: python
    analyzer: static
    knobs:
      enabled: true
      max_file_count: 100              # Files above this threshold trigger finding
    description: "Skill package contains too many files"

  OVERSIZED_FILE:
    source: python
    analyzer: static
    knobs:
      enabled: true
      max_file_size_bytes: 5242880     # 5 MB — files above this trigger finding
    description: "File exceeds maximum allowed size"

  ARCHIVE_CONTAINS_EXECUTABLE:
    source: python
    analyzer: static
    knobs:
      enabled: true
    description: "Archive contains executable script"

  ASSET_PROMPT_INJECTION:
    source: python
    analyzer: static
    knobs:
      enabled: true
      asset_prompt_injection_skip_in_docs: true
    description: "Prompt injection pattern in asset file"

  ASSET_SUSPICIOUS_URL:
    source: python
    analyzer: static
    knobs:
      enabled: true
    description: "Suspicious URL in asset file"

  # ===========================================================================
  # PYTHON RULES – Pipeline Analyzer
  # ===========================================================================

  PIPELINE_TAINT_FLOW:
    source: python
    analyzer: pipeline
    knobs:
      enabled: true
      demote_instructional: true       # Demote instructional install text in SKILL.md
      demote_in_docs: true             # Demote findings in documentation/reference files
    description: "Tainted data flows through command pipeline"

  COMPOUND_FIND_EXEC:
    source: python
    analyzer: pipeline
    knobs:
      enabled: true
      demote_in_docs: true             # Demote findings in documentation/reference files
    description: "find command piped to execution"

  COMPOUND_EXTRACT_EXECUTE:
    source: python
    analyzer: pipeline
    knobs:
      enabled: true
      demote_in_docs: true             # Demote findings in documentation/reference files
    description: "Archive extraction followed by execution"

  COMPOUND_FETCH_EXECUTE:
    source: python
    analyzer: pipeline
    knobs:
      enabled: true
      check_known_installers: true
      demote_in_docs: true
      compound_fetch_require_download_intent: true
      compound_fetch_filter_api_requests: true
      compound_fetch_filter_shell_wrapped_fetch: true
      compound_fetch_exec_prefixes: "sudo,env,command,time,nohup,nice"
      compound_fetch_exec_commands: "bash,sh,zsh,source,python,python3,."
    description: "Remote fetch followed by execution (curl|sh)"

  COMPOUND_LAUNDERING_CHAIN:
    source: python
    analyzer: pipeline
    knobs:
      enabled: true
      demote_in_docs: true             # Demote findings in documentation/reference files
    description: "Data laundering through multiple transforms"

  # ===========================================================================
  # PYTHON RULES – Scanner (analyzability)
  # ===========================================================================

  UNANALYZABLE_BINARY:
    source: python
    analyzer: scanner
    knobs:
      enabled: true
      skip_inert_extensions: true
    description: "Binary file that cannot be inspected"

  LOW_ANALYZABILITY:
    source: python
    analyzer: scanner
    knobs:
      enabled: true
    description: "Overall analyzability score is below threshold"

  FINDING_OUTPUT_NORMALIZATION:
    source: python
    analyzer: scanner
    knobs:
      enabled: true
      dedupe_exact_findings: true
      dedupe_same_issue_per_location: true
      same_issue_preferred_analyzers:
        - "meta_analyzer"
        - "llm_analyzer"
        - "meta"
        - "llm"
        - "behavioral"
        - "pipeline"
        - "static"
        - "yara"
        - "analyzability"
      same_issue_collapse_within_analyzer: true
      annotate_same_path_rule_cooccurrence: true
      attach_policy_fingerprint: true
    description: "Global finding dedupe and policy fingerprint stamping"

  TRIGGER_OVERLAP_RISK:
    source: python
    analyzer: scanner
    knobs:
      enabled: true
    description: "Cross-skill trigger overlap detected (high risk)"

  TRIGGER_OVERLAP_WARNING:
    source: python
    analyzer: scanner
    knobs:
      enabled: true
    description: "Cross-skill trigger overlap detected (warning)"

  # ===========================================================================
  # PYTHON RULES – Content Extractor
  # ===========================================================================

  ARCHIVE_EXTRACTION_FAILED:
    source: python
    analyzer: content_extractor
    knobs:
      enabled: true
    description: "Archive extraction failed"

  ARCHIVE_NESTED_TOO_DEEP:
    source: python
    analyzer: content_extractor
    knobs:
      enabled: true
    description: "Nested archive exceeds depth limit"

  ARCHIVE_ZIP_BOMB:
    source: python
    analyzer: content_extractor
    knobs:
      enabled: true
    description: "Potential zip bomb detected"

  ARCHIVE_PATH_TRAVERSAL:
    source: python
    analyzer: content_extractor
    knobs:
      enabled: true
    description: "Archive contains path traversal entries"

  OFFICE_VBA_MACRO:
    source: python
    analyzer: content_extractor
    knobs:
      enabled: true
    description: "VBA macro detected in Office document"

  OFFICE_EMBEDDED_OLE:
    source: python
    analyzer: content_extractor
    knobs:
      enabled: true
    description: "Embedded OLE object in Office document"

  # ===========================================================================
  # PYTHON RULES – Behavioral Analyzer
  # ===========================================================================

  BEHAVIOR_ENV_VAR_EXFILTRATION:
    source: python
    analyzer: behavioral
    knobs:
      enabled: true
    description: "Environment variable exfiltration pattern"

  BEHAVIOR_CREDENTIAL_FILE_ACCESS:
    source: python
    analyzer: behavioral
    knobs:
      enabled: true
    description: "Credential file access detected"

  BEHAVIOR_ENV_VAR_HARVESTING:
    source: python
    analyzer: behavioral
    knobs:
      enabled: true
    description: "Bulk environment variable harvesting"

  BEHAVIOR_SUSPICIOUS_URL:
    source: python
    analyzer: behavioral
    knobs:
      enabled: true
    description: "Suspicious URL pattern detected"

  BEHAVIOR_EVAL_SUBPROCESS:
    source: python
    analyzer: behavioral
    knobs:
      enabled: true
    description: "eval/exec with subprocess interaction"

  BEHAVIOR_BASH_TAINT_FLOW:
    source: python
    analyzer: behavioral
    knobs:
      enabled: true
    description: "Tainted data in bash code block"

  MDBLOCK_PYTHON_EVAL_EXEC:
    source: python
    analyzer: behavioral
    knobs:
      enabled: true
    description: "eval/exec in markdown Python code block"

  MDBLOCK_PYTHON_SUBPROCESS:
    source: python
    analyzer: behavioral
    knobs:
      enabled: true
    description: "subprocess in markdown Python code block"

  MDBLOCK_PYTHON_HTTP_POST:
    source: python
    analyzer: behavioral
    knobs:
      enabled: true
    description: "HTTP POST in markdown Python code block"

  # ===========================================================================
  # PYTHON RULES – Trigger Analyzer
  # ===========================================================================

  TRIGGER_OVERLY_GENERIC:
    source: python
    analyzer: trigger
    knobs:
      enabled: true
    description: "Trigger description is too generic"

  TRIGGER_DESCRIPTION_TOO_SHORT:
    source: python
    analyzer: trigger
    knobs:
      enabled: true
    description: "Trigger description is too short"

  TRIGGER_VAGUE_DESCRIPTION:
    source: python
    analyzer: trigger
    knobs:
      enabled: true
    description: "Trigger description is vague"

  TRIGGER_KEYWORD_BAITING:
    source: python
    analyzer: trigger
    knobs:
      enabled: true
    description: "Trigger uses keyword-baiting patterns"

  # ===========================================================================
  # PYTHON RULES – Bytecode Analyzer
  # ===========================================================================

  BYTECODE_NO_SOURCE:
    source: python
    analyzer: bytecode
    knobs:
      enabled: true
    description: "Compiled bytecode without matching source"

  BYTECODE_SOURCE_MISMATCH:
    source: python
    analyzer: bytecode
    knobs:
      enabled: true
    description: "Bytecode does not match source code"
